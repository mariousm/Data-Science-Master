---
title: "Exercises"
author: "Mario Ubierna San Mamés"
date: '`r format(Sys.Date(),"%e de %B, %Y")`'
output:
  html_document:
    highlight: default
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_depth: 2
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

******
# Generar Secuencias
******
  
Rellenar los vectores siguientes:
<li> v1: 1 2 3 </li>
<li> v2: 1 2 3 1 2 3 1 2 3 </li>
<li> v3: 0 10 20 30 40 50 60 70 80 90 100 </li>
<li> v4: 1000 900 800 700 600 500 400 300 200 100 0 </li>
<li> v5: 1 1 1 1 1 </li>
<br>

```{r}
v1 <- c(1,2,3)
v1
```


```{r}
v2 <- rep(v1, times=3 )
v2
```


```{r}
v3 <- seq(0, 100, by=10)
v3
```


```{r}
v4 <- seq(1000, 0, by=-100)
v4
```


```{r}
v5 <- rep(1, times=5)
v5
```

******
# Realizar cálculos a nivel de vector
******
<ol>
  <li> Cacular la suma, media, rango, máximo y mínimo de un vector de números que        contiene valores desde 1,500 hasta 500 step -2. </li>
  <li> Ordenar el vector en orden creciente </li>
  <li> Contar cuantos elementos hay en el vector. </li>
</ol>
<br>
```{r}
v <- seq(1500, 500, by=-2)
#v
```


```{r}
cat("La suma es:\t", sum(v))
```


```{r}
cat("La media es:\t", mean(v))
```


```{r}
cat("El rango es:\t", range(v))
```


```{r}
cat("El máximo es:\t", max(v))
```


```{r}
cat("El mínimo es:\t", min(v))
```


```{r}
sort(v)
```


```{r}
length(v)
```


******
# Cálculos aritméticos con vectores numéricos
******
<ol>
  <li> Crear un vector con valores de 1 a 20. </li>
  <li> Restar 1 a todos los elementos del vector. </li>
  <li> Para cada elemento, calcular su cuadrado. </li>
</ol>
<br>

```{r}
v <- seq(1, 20)
v
```


```{r}
v <- v - 1
v
```


```{r}
v^2
```


******
# Cálculos aritméticos con varios vectores
******
<ol>
  <li> Crer un vector v1 con valores de 0 a 20 y otro vector v2 con valores de -10 to +10. </li>
  <li> Generar un vector vsum que contiene la suma de los elementos de los dos vectores, posición por posición. </li>
</ol>
<br>

```{r}
v1 <- seq(0, 20)
cat("El vector v1:\t", v1)
```


```{r}
v2 <- c(-10:10)
cat("El vector v2:\t", v2)
```


```{r}
vsum <- v1 + v2
vsum
```


******
# Vectores numéricos
******
Disponemos de un vector "quantity" y un vector de precios "price":
  <li> quantity: 20 3 4 5 6 7 8 5 2 12 </li>
  <li> price: 2 4 5 63 40 21 12 6 7 4 </li>
Cada posición del vector quantity es la cantidad de productos vendidos. El precio está guardado en la misma posición del vector price. Calcular el precio total de todos los productos.
<br>


```{r}
quantity <- c(20,3,4,5,6,7,8,5,2,12)
price <- c(2,4,5,63,40,21,12,6,7,4)
```


```{r}
quantity
```


```{r}
price
```


```{r}
total_price <- quantity * price
sum(total_price)
```


******
# Vectores numéricos y lógicos
******
Dados los siguientes vectores:
<p>x: 3 4 6 -5 1 3 9 10 -1 0 -4</p>
<p>y: -4 4 6 5 1 3 9 1 -10 5 14</p>

Realizar los cálculos siguientes:
<ol>
 <li> Cuántos elementos del vextor x son positivos?</li>
 <br>
```{r}
x <- c(3,4,6,-5,1,3,9,10,-1,0,-4)
y <- c(-4,4,6,5,1,3,9,1,-10,5,14)
```


```{r}
sum(x > 0)
length(which(x > 0))
```

<li> Qué elementos del vector x son mayores que los elementos del vector y (considerando posición por posición). </li>
<br>

```{r}
index <- which(x > y)
index
```
```{r}
x[index]
x[x > y]
```


<li>Borrar del vector x los elementos que son iguales a los elementos que ocupan la misma posición en y.</li>
<br>
 
```{r}
# Borrando a partir de los índices
index <- which(x == y)
x <- x[-index]
x
# Borrando sin índices
x <- c(3,4,6,-5,1,3,9,10,-1,0,-4)
x <- x[!(x == y)]
x
```
 
</ol>

******
# Factors
******
<p>El siguiente vector pertenece al nivel de estudios de 20 personas:</p>
<p>studies <- c(“n”, “p”, “s”, “p”, “s”, “t”, “o”, “s”, “o” , “p”, “p”,“s”, “s”,“t”,“p”,“t”,“o”,“n”,“p”,“o”)</p>
<ol>
  <li>Calcular cuántos tipos de educación hay.</li>
  <li>Para hacerlo más comprensible, cambiar el valor de los niveles a los siguientes:
  n : none
  
  p : primary
  
  s : secondary
  
  t : tertiary
  
  o : other</li>

<li>Mostrar cuantas personas hay para cada tipo de educación.</li>
</ol>
<br>

```{r}
studies <- factor(c("n", "p", "s", "p", "s", "t", "o", "s", "o" , "p", "p","s", "s","t","p","t","o","n","p","o"))
```

```{r}
levels(studies)
```

```{r}
levels(studies) <- c("none", "other", "primary", "secondary", "tertiary")
studies
```

```{r}
cat("Número de none:\t", length(studies[studies == "none"]))
cat("Número de other:\t", length(studies[studies == "other"]))
cat("Número de primary:\t", length(studies[studies == "primary"]))
cat("Número de secondary:\t", length(studies[studies == "secondary"]))
cat("Número de tertiary:\t", length(studies[studies == "tertiary"]))
```

```{r}
table(studies)
```


******
# Matrices
******
<ol>
  <li>
    Generar una matriz de 10 filas y 6 columnas, cuyos valores de cada columna son los múltiples del índice de la columna, tal como sigue:  
    
   [1,] 1 2 3 4 5 6

  [2,] 2 4 6 8 10 12

  [3,] 3 6 9 12 15 18

  [4,] 4 8 12 16 20 24

  [5,] 5 10 15 20 25 30

  [6,] 6 12 18 24 30 36

  [7,] 7 14 21 28 35 42

  [8,] 8 16 24 32 40 48

  [9,] 9 18 27 36 45 54

  [10,] 10 20 30 40 50 60
  </li>
  <li>Etiquetar cada columna como: M1, M2, … M6</li>
  <li>Borrar las dos últimas filas.</li>
  <li>Cambiar el signo de los valores de la columna 3.</li>
  <li>Mostrar el contenido de la columna 2.</li>
</ol>
<br>

```{r}
v1 <- c(1:6)
v2 <- v1*2
v3 <- v1*3
v4 <- v1*4
v5 <- v1*5
v6 <- v1*6
v7 <- v1*7
v8 <- v1*8
v9 <- v1*9
v10 <- v1*10

matrix <- rbind(v1, v2, v3, v4, v5, v6, v7, v8, v9, v10)
matrix
```

```{r}
colnames(matrix) <- c("M1", "M2", "M3", "M4", "M5", "M6")
matrix
```

```{r}
matrix = matrix[-c(9, 10),]
# También se puede hacer de esta otra forma
matrix = matrix[1:8,]
matrix
```

```{r}
matrix[,3] = matrix[,3] * -1
matrix
```

```{r}
matrix[,2]
```


******
# Data Frames
******
<ol>
<li>Leer el fichero “bank.csv” (http://archive.ics.uci.edu/ml/datasets/Bank+Marketing) y guardar los datos en un data frame. Verificar que la información se ha leído correctamente en el data.frame.</li>
<li>Calcular el promedio de edad.</li>
<li>Calcular cuantos trabajos diferentes hay en la muestra.</li>
<li>Calcular cuantas personas hay de cada tipo de trabajo.</li>
<li>Calcular cuantos “entprepreneurs” hay.</li>
<li>Seleccionar los individuos que son emprendedores y calcular su promedio de edad.</li>
<li>Seleccionar los emprenedores cuya edad es inferior al promedio de edad de los emprenedeores. ¿Cuántos son?</li>
<li>¿Cuál es el nivel de estudios de estos emprendedores jóvenes?</li>
<li>Borrar del data frame todos los emprendedores jóvenes.</li>
</ol>
<br>

```{r}
df = read.csv(file="./data/bank.csv", sep=";", na.strings="NA")
head(df)
```

```{r}
# Promedio
promedio = mean(df$age)
promedio
```

```{r}
# Número de trabajos diferentes

# Cambio la columna del job de char a Factor, para así poder hacer uso de levels y contar los elementos
df$job = as.factor(df$job)
levels(df$job)

```

```{r}
# Calcular cuantas personas hay de cada tipo de trabajo.
table(df$job)
```

```{r}
# Calcular cuantos “entprepreneurs” hay.
length(which(df$job == "entrepreneur"))
```

```{r}
# Seleccionar los individuos que son emprendedores y calcular su promedio de edad.
df_emprendedores = df[df$job == "entrepreneur", ]
head(df_emprendedores)
# Promedio
promedio = mean(df_emprendedores$age)
promedio
```

```{r}
# Seleccionar los emprenedores cuya edad es inferior al promedio de edad de los emprenedeores. ¿Cuántos son?

df_emprendedores_jovenes = df_emprendedores[df_emprendedores$age < promedio, ]
nrow(df_emprendedores_jovenes)
```

```{r}
# ¿Cuál es el nivel de estudios de estos emprendedores jóvenes?
table(df_emprendedores_jovenes$education)
```

```{r}
# Borrar del data frame todos los emprendedores jóvenes.

index = which(df$job == 'entrepreneur' & df$age<promedio)
df = df[-index, ]
head(df)
```

******
# Ejercicio resumen
******
Dado el siguiente vector generado aleatoriamente:  

 x<-round( rnorm(300, mean=25, sd=9) )

x<-x[x>10]

Supongamos que pertenece a las edades de 300 individuos. Calcular:
<ol>

<li>Copiar la información en un fichero “ages.csv”</li>
<li>Leer el fichero y cargar los datos de las edades de nuevo.</li>
<li>Calcular cuantos individuos hay en la muestra.</li>
<li>Calcular el máximo, mínimo, promedio y mediana.</li>
<li>¿Cuántas personas de cada edad hay en la muestra?</li>
<li>Calcular la fecha de nacimiento de cada persona.</li>
<li>Selecionar las personas que nacieron entre 1980 and 2000, ambos incluidos.</li>
<li>Calcular cuantos jugadores hay mayores de 30 años y cuántos son menores de 20.</li>
<li>Convertir los valores en un nuevo vector, donde se clasifican los individuos en:
VY (very young): <20 años

Y (young), 20-34 años

A (adult): 35-49 años

OA (older adult): 50-65 años

O (old): >65 años</li>

<li>Calculas cuantos individuos hay de cada categoría de edad.</li>
</ol>
<br>

```{r}
x<-round( rnorm(300, mean=25, sd=9) )
x<-x[x>10]
```

```{r}
# Copiar la información en un fichero “ages.csv”
x = as.data.frame(x)
write.csv(x, file="./data/ages.csv",row.names=F)
```

```{r}
# Leer el fichero y cargar los datos de las edades de nuevo.
ages = read.csv("./data/ages.csv")$x
head(ages)
```

```{r}
# Calcular cuantos individuos hay en la muestra.
length(ages)
```

```{r}
# Calcular el máximo, mínimo, promedio y mediana.
cat("El máximo es: \t", max(ages))
cat("El mínimo es: \t", min(ages))
cat("El promedio es: \t", mean(ages))
cat("El mediana es: \t", median(ages))
```

```{r}
# ¿Cuántas personas de cada edad hay en la muestra?
table(ages)
```

```{r}
# Calcular la fecha de nacimiento de cada persona.
birthDate = 2021 - ages
birthDate
```

```{r}
# Selecionar las personas que nacieron entre 1980 and 2000, ambos incluidos.
birthDate[birthDate >= 1980 & birthDate <= 2000]
```

```{r}
# Calcular cuantos jugadores hay mayores de 30 años y cuántos son menores de 20.
cat("Mayores de 30: \t", length(ages[ages > 30]))
cat("Menores de 20: \t", length(ages[ages < 20]))
```

```{r}
# Convertir los valores en un nuevo vector
ages_category = ages
ages_category[ages < 20] = "VY"
ages_category[ages >= 20 & ages <= 34] = "Y"
ages_category[ages >= 35 & ages <= 49] = "A"
ages_category[ages >= 50 & ages <= 65] = "OA"
ages_category[ages > 65] = "O"
ages_category
```

```{r}
# Calculas cuantos individuos hay de cada categoría de edad.
table(ages_category)
```

